#!/usr/bin/env python# encoding: utf-8"""@author:Eric.xin"""import osimport sysimport loggingimport MySQLdb as MySQLtop = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))sys.path.append(top)from Conf import s_configLOG_INFO = os.path.join(top, "logs", "source_data_all.log")LOG_ERROR = os.path.join(top, "logs", "source_data_error.log")SQL_SELECT = "select user_id,available_amount/100, freeze_amount/100, ds_principal/100, ds_interest/100, reward/100" \             " from jr_pay.pay_account"class SourceDB(object):    def __init__(self, host, user, password, databases, port=3306):        self.host = host        self.user = user        self.password = password        self.databases = databases        self.port = port        self.__result = dict()        self.__user_id = list()        self.__available_amount = list()        self.__freeze_amount = list()        self.__ds_principal = list()        self.__ds_interest = list()        self.__reward = list()        logging.basicConfig(level=logging.INFO, filename=LOG_INFO, format='%(asctime)s  %(message)s')        logging.basicConfig(level=logging.INFO, filename=LOG_ERROR, format='%(asctime)s  %(message)s')    def get_data(self):        conn = None        cursor = None        try:            conn = MySQL.connect(self.host, self.user, self.password, self.databases, port=self.port)  # 连接数据库            cursor = conn.cursor()  # 游标            cursor.execute(SQL_SELECT)  # 执行查询语句            result_data = cursor.fetchall()  # 获取所有数据        except Exception as e:            logging.info(u"网络异常无法连接到 %s  %s" % (self.host, e))            return None        finally:            if cursor:                cursor.close()            if conn:                conn.close()        for data in result_data:            self.__user_id.append(data[0])  # 用户id            self.__available_amount.append(data[1])  # 可用余额            self.__freeze_amount.append(data[2])  # 冻结金额            self.__ds_principal.append(data[3])  # 待收本金            self.__ds_interest.append(data[4])  # 待收收益            self.__reward.append(data[5])  # 奖励金额        self.__result['user_id'] = self.__user_id        self.__result['available_amount'] = self.__available_amount        self.__result['freeze_amount'] = self.__freeze_amount        self.__result['ds_principal'] = self.__ds_principal        self.__result['ds_interest'] = self.__ds_interest        self.__result['reward'] = self.__reward        return self.__resultif __name__ == "__main__":    s = SourceDB(s_config.ip, s_config.user, s_config.pwd, s_config.db)    print s.get_data().keys()